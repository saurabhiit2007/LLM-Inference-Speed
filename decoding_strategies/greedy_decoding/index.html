
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A technical reference for LoRA, QLoRA, and other fine-tuning techniques.">
      
      
        <meta name="author" content="Saurabh Goyal">
      
      
      
        <link rel="prev" href="../../attention_optimization/paged_attention/">
      
      
        <link rel="next" href="../beam_search/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Greedy Decoding - Fine-Tuning Methods Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#greedy-decoding-interview-prep-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Fine-Tuning Methods Documentation" class="md-header__button md-logo" aria-label="Fine-Tuning Methods Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Fine-Tuning Methods Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Greedy Decoding
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="lime"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/saurabhiit2007/LLM-Finetuning" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Fine-Tuning Methods Documentation" class="md-nav__button md-logo" aria-label="Fine-Tuning Methods Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Fine-Tuning Methods Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/saurabhiit2007/LLM-Finetuning" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fundamentals/inference_basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inference Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fundamentals/bottleneck_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bottleneck Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fundamentals/latency_vs_throughput/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Latency vs Throughput
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fundamentals/memory_compute_tradeoffs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memory Compute Tradeoffs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Attention Optimization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Attention Optimization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attention_optimization/flash_attention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flash Attention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attention_optimization/flash_attention_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flash Attention 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attention_optimization/kv_caching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    KV Caching
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attention_optimization/paged_attention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Paged Attention
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Decoding Strategies
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Decoding Strategies
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Greedy Decoding
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Greedy Decoding
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-overview" class="md-nav__link">
    <span class="md-ellipsis">
      1. Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      2. How It Works
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. How It Works">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-key-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      3. Key Characteristics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Key Characteristics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deterministic" class="md-nav__link">
    <span class="md-ellipsis">
      Deterministic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#myopic-short-sighted" class="md-nav__link">
    <span class="md-ellipsis">
      Myopic (Short-sighted)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-common-problems" class="md-nav__link">
    <span class="md-ellipsis">
      4. Common Problems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Common Problems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#problem-1-repetition-loops" class="md-nav__link">
    <span class="md-ellipsis">
      Problem 1: Repetition Loops
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-2-generic-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Problem 2: Generic Outputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-3-early-mistakes-propagate" class="md-nav__link">
    <span class="md-ellipsis">
      Problem 3: Early Mistakes Propagate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-when-to-use-greedy-decoding" class="md-nav__link">
    <span class="md-ellipsis">
      5. When to Use Greedy Decoding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. When to Use Greedy Decoding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#good-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      ✅ Good Use Cases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#poor-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      ❌ Poor Use Cases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-practical-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      6. Practical Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Practical Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#computational-complexity" class="md-nav__link">
    <span class="md-ellipsis">
      Computational Complexity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modifications" class="md-nav__link">
    <span class="md-ellipsis">
      Modifications
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-interview-questions" class="md-nav__link">
    <span class="md-ellipsis">
      7. Interview Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Interview Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#q1-what-is-greedy-decoding-and-how-does-it-work" class="md-nav__link">
    <span class="md-ellipsis">
      Q1: What is greedy decoding and how does it work?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q2-why-is-greedy-decoding-called-greedy" class="md-nav__link">
    <span class="md-ellipsis">
      Q2: Why is greedy decoding called "greedy"?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q3-whats-the-main-disadvantage-of-greedy-decoding" class="md-nav__link">
    <span class="md-ellipsis">
      Q3: What's the main disadvantage of greedy decoding?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q4-how-does-greedy-decoding-differ-from-beam-search" class="md-nav__link">
    <span class="md-ellipsis">
      Q4: How does greedy decoding differ from beam search?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q5-can-greedy-decoding-produce-the-optimal-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      Q5: Can greedy decoding produce the optimal sequence?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q6-why-does-greedy-decoding-cause-repetition" class="md-nav__link">
    <span class="md-ellipsis">
      Q6: Why does greedy decoding cause repetition?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q7-how-can-you-reduce-repetition-in-greedy-decoding" class="md-nav__link">
    <span class="md-ellipsis">
      Q7: How can you reduce repetition in greedy decoding?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q8-whats-the-computational-cost-of-greedy-decoding" class="md-nav__link">
    <span class="md-ellipsis">
      Q8: What's the computational cost of greedy decoding?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q9-when-would-you-prefer-greedy-over-beam-search" class="md-nav__link">
    <span class="md-ellipsis">
      Q9: When would you prefer greedy over beam search?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q10-how-does-greedy-decoding-interact-with-temperature" class="md-nav__link">
    <span class="md-ellipsis">
      Q10: How does greedy decoding interact with temperature?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-comparison-with-other-methods" class="md-nav__link">
    <span class="md-ellipsis">
      8. Comparison with Other Methods
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-code-example" class="md-nav__link">
    <span class="md-ellipsis">
      9. Code Example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-key-takeaways-for-interviews" class="md-nav__link">
    <span class="md-ellipsis">
      10. Key Takeaways for Interviews
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../beam_search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Beam Search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sampling_methods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sampling Methods
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../speculative_decoding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Speculative Decoding
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../batching_strategies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Batching Strategies
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Quantization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Quantization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/quantization_basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantization Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/int8_quantization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    INT8 Quantization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/int4_quantization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    INT4 Quantization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/gptq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GPTQ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/awq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AWQ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/smoothquant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SmoothQuant
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/gguf_ggml/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GGUF GGML
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quantization/quantization_tradeoffs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantization Tradeoffs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Serving Frameworks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Serving Frameworks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../serving_frameworks/tensorrt_llm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TensorRT LLM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../serving_frameworks/text_generation_inference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Text Generation Inference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../serving_frameworks/deepspeed_inference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DeepSpeed Inference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../serving_frameworks/triton_inference_server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Triton Inference Server
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../serving_frameworks/vllm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    vLLM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../serving_frameworks/framework_comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Framework Comparison
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-overview" class="md-nav__link">
    <span class="md-ellipsis">
      1. Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-how-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      2. How It Works
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. How It Works">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      Example
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-key-characteristics" class="md-nav__link">
    <span class="md-ellipsis">
      3. Key Characteristics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Key Characteristics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deterministic" class="md-nav__link">
    <span class="md-ellipsis">
      Deterministic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#myopic-short-sighted" class="md-nav__link">
    <span class="md-ellipsis">
      Myopic (Short-sighted)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-common-problems" class="md-nav__link">
    <span class="md-ellipsis">
      4. Common Problems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Common Problems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#problem-1-repetition-loops" class="md-nav__link">
    <span class="md-ellipsis">
      Problem 1: Repetition Loops
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-2-generic-outputs" class="md-nav__link">
    <span class="md-ellipsis">
      Problem 2: Generic Outputs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-3-early-mistakes-propagate" class="md-nav__link">
    <span class="md-ellipsis">
      Problem 3: Early Mistakes Propagate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-when-to-use-greedy-decoding" class="md-nav__link">
    <span class="md-ellipsis">
      5. When to Use Greedy Decoding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. When to Use Greedy Decoding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#good-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      ✅ Good Use Cases
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#poor-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      ❌ Poor Use Cases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-practical-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      6. Practical Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Practical Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#computational-complexity" class="md-nav__link">
    <span class="md-ellipsis">
      Computational Complexity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modifications" class="md-nav__link">
    <span class="md-ellipsis">
      Modifications
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-interview-questions" class="md-nav__link">
    <span class="md-ellipsis">
      7. Interview Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Interview Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#q1-what-is-greedy-decoding-and-how-does-it-work" class="md-nav__link">
    <span class="md-ellipsis">
      Q1: What is greedy decoding and how does it work?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q2-why-is-greedy-decoding-called-greedy" class="md-nav__link">
    <span class="md-ellipsis">
      Q2: Why is greedy decoding called "greedy"?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q3-whats-the-main-disadvantage-of-greedy-decoding" class="md-nav__link">
    <span class="md-ellipsis">
      Q3: What's the main disadvantage of greedy decoding?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q4-how-does-greedy-decoding-differ-from-beam-search" class="md-nav__link">
    <span class="md-ellipsis">
      Q4: How does greedy decoding differ from beam search?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q5-can-greedy-decoding-produce-the-optimal-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      Q5: Can greedy decoding produce the optimal sequence?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q6-why-does-greedy-decoding-cause-repetition" class="md-nav__link">
    <span class="md-ellipsis">
      Q6: Why does greedy decoding cause repetition?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q7-how-can-you-reduce-repetition-in-greedy-decoding" class="md-nav__link">
    <span class="md-ellipsis">
      Q7: How can you reduce repetition in greedy decoding?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q8-whats-the-computational-cost-of-greedy-decoding" class="md-nav__link">
    <span class="md-ellipsis">
      Q8: What's the computational cost of greedy decoding?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q9-when-would-you-prefer-greedy-over-beam-search" class="md-nav__link">
    <span class="md-ellipsis">
      Q9: When would you prefer greedy over beam search?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#q10-how-does-greedy-decoding-interact-with-temperature" class="md-nav__link">
    <span class="md-ellipsis">
      Q10: How does greedy decoding interact with temperature?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-comparison-with-other-methods" class="md-nav__link">
    <span class="md-ellipsis">
      8. Comparison with Other Methods
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-code-example" class="md-nav__link">
    <span class="md-ellipsis">
      9. Code Example
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-key-takeaways-for-interviews" class="md-nav__link">
    <span class="md-ellipsis">
      10. Key Takeaways for Interviews
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="greedy-decoding-interview-prep-guide">Greedy Decoding - Interview Prep Guide<a class="headerlink" href="#greedy-decoding-interview-prep-guide" title="Permanent link">&para;</a></h1>
<h2 id="1-overview">1. Overview<a class="headerlink" href="#1-overview" title="Permanent link">&para;</a></h2>
<p>Greedy decoding selects the token with the <strong>highest probability</strong> at each step during autoregressive text generation. It's the simplest and fastest decoding strategy but lacks diversity.</p>
<p><strong>Key insight:</strong> Local optimization (best token at each step) doesn't guarantee global optimality (best overall sequence).</p>
<hr />
<h2 id="2-how-it-works">2. How It Works<a class="headerlink" href="#2-how-it-works" title="Permanent link">&para;</a></h2>
<h3 id="algorithm">Algorithm<a class="headerlink" href="#algorithm" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">greedy_decode</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">prompt</span><span class="p">,</span> <span class="n">max_length</span><span class="p">):</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="n">prompt</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">):</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>  <span class="c1"># Shape: (vocab_size,)</span>
        <span class="n">next_token</span> <span class="o">=</span> <span class="n">argmax</span><span class="p">(</span><span class="n">logits</span><span class="p">)</span>  <span class="c1"># Pick highest probability</span>
        <span class="n">tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_token</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">next_token</span> <span class="o">==</span> <span class="n">EOS</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">tokens</span>
</code></pre></div>
<h3 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h3>
<p>Given probability distribution after "The cat sat on the":</p>
<table>
<thead>
<tr>
<th>Token</th>
<th>Probability</th>
</tr>
</thead>
<tbody>
<tr>
<td>mat</td>
<td>0.40</td>
</tr>
<tr>
<td>floor</td>
<td>0.25</td>
</tr>
<tr>
<td>sofa</td>
<td>0.15</td>
</tr>
<tr>
<td>bed</td>
<td>0.10</td>
</tr>
</tbody>
</table>
<p><strong>Greedy choice:</strong> <code>mat</code> (highest probability)</p>
<p><strong>Output:</strong> "The cat sat on the mat"</p>
<hr />
<h2 id="3-key-characteristics">3. Key Characteristics<a class="headerlink" href="#3-key-characteristics" title="Permanent link">&para;</a></h2>
<h3 id="deterministic">Deterministic<a class="headerlink" href="#deterministic" title="Permanent link">&para;</a></h3>
<ul>
<li>Same input → always same output</li>
<li>No randomness involved</li>
<li>Fully reproducible</li>
</ul>
<h3 id="myopic-short-sighted">Myopic (Short-sighted)<a class="headerlink" href="#myopic-short-sighted" title="Permanent link">&para;</a></h3>
<p>Each decision is locally optimal but may lead to suboptimal sequences:</p>
<div class="highlight"><pre><span></span><code>Step 1: &quot;I think&quot; → model assigns:
  - &quot;that&quot; (0.6)
  - &quot;the&quot; (0.4)

Greedy picks: &quot;that&quot;

Step 2: &quot;I think that&quot; → model assigns:
  - &quot;is&quot; (0.3)
  - &quot;maybe&quot; (0.25)

But if we had picked &quot;the&quot; at step 1:
  &quot;I think the&quot; → &quot;best&quot; (0.7)

Final: &quot;I think that is...&quot; (score: 0.6 × 0.3 = 0.18)
Better: &quot;I think the best...&quot; (score: 0.4 × 0.7 = 0.28)
</code></pre></div>
<p>Greedy can't recover from early suboptimal choices.</p>
<hr />
<h2 id="4-common-problems">4. Common Problems<a class="headerlink" href="#4-common-problems" title="Permanent link">&para;</a></h2>
<h3 id="problem-1-repetition-loops">Problem 1: Repetition Loops<a class="headerlink" href="#problem-1-repetition-loops" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Prompt: &quot;To be or not to&quot;
Output: &quot;be or not to be or not to be or not to be...&quot;
</code></pre></div>
<p><strong>Why:</strong> If "be" has slightly higher probability than alternatives at each step, greedy gets stuck.</p>
<h3 id="problem-2-generic-outputs">Problem 2: Generic Outputs<a class="headerlink" href="#problem-2-generic-outputs" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Prompt: &quot;Write a creative story about&quot;
Greedy: &quot;a boy who lived in a small town and went to school...&quot;
</code></pre></div>
<p>Always picks safe, high-probability continuations → boring text.</p>
<h3 id="problem-3-early-mistakes-propagate">Problem 3: Early Mistakes Propagate<a class="headerlink" href="#problem-3-early-mistakes-propagate" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>Prompt: &quot;The capital of France is&quot;
If model assigns:
  - &quot;Paris&quot; (0.45)
  - &quot;Lyon&quot; (0.46)  ← greedy picks this (wrong!)

Output: &quot;Lyon, which is known for...&quot;
</code></pre></div>
<p>Once the wrong token is chosen, subsequent tokens try to justify it.</p>
<hr />
<h2 id="5-when-to-use-greedy-decoding">5. When to Use Greedy Decoding<a class="headerlink" href="#5-when-to-use-greedy-decoding" title="Permanent link">&para;</a></h2>
<h3 id="good-use-cases">✅ Good Use Cases<a class="headerlink" href="#good-use-cases" title="Permanent link">&para;</a></h3>
<p><strong>Deterministic tasks:</strong>
- Math problem solving
- Code generation (when exact output matters)
- Factual Q&amp;A with clear answers
- Translation of standardized text</p>
<p><strong>Debugging:</strong>
- Baseline comparisons
- Reproducible testing
- Fastest inference for quick experiments</p>
<p><strong>Confident models:</strong>
- When model probability distributions are very peaked
- Single obvious correct answer</p>
<h3 id="poor-use-cases">❌ Poor Use Cases<a class="headerlink" href="#poor-use-cases" title="Permanent link">&para;</a></h3>
<p><strong>Creative tasks:</strong>
- Story writing
- Poetry generation
- Brainstorming</p>
<p><strong>Conversational AI:</strong>
- Chatbots
- Dialogue systems
- Personality-driven responses</p>
<p><strong>Long-form generation:</strong>
- Articles, essays
- Open-ended content</p>
<hr />
<h2 id="6-practical-considerations">6. Practical Considerations<a class="headerlink" href="#6-practical-considerations" title="Permanent link">&para;</a></h2>
<h3 id="computational-complexity">Computational Complexity<a class="headerlink" href="#computational-complexity" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Time:</strong> O(T × V) where T = sequence length, V = vocab size</li>
<li><strong>Space:</strong> O(1) for decoding state (minimal memory)</li>
<li><strong>Fastest</strong> among all decoding strategies</li>
</ul>
<h3 id="modifications">Modifications<a class="headerlink" href="#modifications" title="Permanent link">&para;</a></h3>
<p><strong>Greedy + repetition penalty:</strong>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">greedy_with_penalty</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">previous_tokens</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="mf">1.2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">previous_tokens</span><span class="p">:</span>
        <span class="n">logits</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">/=</span> <span class="n">penalty</span>  <span class="c1"># Reduce probability of repeated tokens</span>
    <span class="k">return</span> <span class="n">argmax</span><span class="p">(</span><span class="n">logits</span><span class="p">)</span>
</code></pre></div></p>
<p><strong>Greedy + length normalization:</strong>
Useful when comparing sequences of different lengths (not during decoding itself).</p>
<hr />
<h2 id="7-interview-questions">7. Interview Questions<a class="headerlink" href="#7-interview-questions" title="Permanent link">&para;</a></h2>
<h3 id="q1-what-is-greedy-decoding-and-how-does-it-work">Q1: What is greedy decoding and how does it work?<a class="headerlink" href="#q1-what-is-greedy-decoding-and-how-does-it-work" title="Permanent link">&para;</a></h3>
<p><strong>Answer:</strong> Greedy decoding selects the token with the highest probability at each generation step. It's deterministic and fast but locally optimal—it picks the best next token without considering whether this leads to the best overall sequence.</p>
<hr />
<h3 id="q2-why-is-greedy-decoding-called-greedy">Q2: Why is greedy decoding called "greedy"?<a class="headerlink" href="#q2-why-is-greedy-decoding-called-greedy" title="Permanent link">&para;</a></h3>
<p><strong>Answer:</strong> It's "greedy" because it makes the locally optimal choice at each step (highest probability token) without considering future consequences. Like the greedy algorithm paradigm, it optimizes immediate reward rather than global optimality.</p>
<hr />
<h3 id="q3-whats-the-main-disadvantage-of-greedy-decoding">Q3: What's the main disadvantage of greedy decoding?<a class="headerlink" href="#q3-whats-the-main-disadvantage-of-greedy-decoding" title="Permanent link">&para;</a></h3>
<p><strong>Answer:</strong> <strong>Lack of diversity and repetition.</strong> Greedy often produces repetitive, generic text because it can't explore alternative paths. Once it makes a suboptimal choice, it can't backtrack, leading to error propagation and repetitive loops.</p>
<hr />
<h3 id="q4-how-does-greedy-decoding-differ-from-beam-search">Q4: How does greedy decoding differ from beam search?<a class="headerlink" href="#q4-how-does-greedy-decoding-differ-from-beam-search" title="Permanent link">&para;</a></h3>
<p><strong>Answer:</strong>
- <strong>Greedy:</strong> Keeps only 1 hypothesis (best token at each step)
- <strong>Beam search:</strong> Keeps K hypotheses (top-K sequences), explores multiple paths</p>
<p>Beam search can recover from locally suboptimal choices by considering alternative sequences. Greedy cannot.</p>
<hr />
<h3 id="q5-can-greedy-decoding-produce-the-optimal-sequence">Q5: Can greedy decoding produce the optimal sequence?<a class="headerlink" href="#q5-can-greedy-decoding-produce-the-optimal-sequence" title="Permanent link">&para;</a></h3>
<p><strong>Answer:</strong> Not necessarily. Greedy finds a <strong>locally optimal</strong> sequence but not necessarily <strong>globally optimal</strong>. The highest-probability sequence might require choosing a lower-probability token early on that leads to much higher probabilities later.</p>
<hr />
<h3 id="q6-why-does-greedy-decoding-cause-repetition">Q6: Why does greedy decoding cause repetition?<a class="headerlink" href="#q6-why-does-greedy-decoding-cause-repetition" title="Permanent link">&para;</a></h3>
<p><strong>Answer:</strong> If a token or phrase has slightly higher probability than alternatives, greedy will keep selecting it. For example, in "to be or not to be or not to be...", if "be" consistently has a small probability advantage, the model gets stuck in a loop with no mechanism to escape.</p>
<hr />
<h3 id="q7-how-can-you-reduce-repetition-in-greedy-decoding">Q7: How can you reduce repetition in greedy decoding?<a class="headerlink" href="#q7-how-can-you-reduce-repetition-in-greedy-decoding" title="Permanent link">&para;</a></h3>
<p><strong>Answer:</strong> Common techniques:
1. <strong>Repetition penalty:</strong> Divide logits of previously generated tokens by penalty factor (e.g., 1.2)
2. <strong>N-gram blocking:</strong> Prevent repeating same N-grams
3. <strong>Switch to sampling:</strong> Use temperature/top-p for diversity
4. <strong>Beam search:</strong> Explore multiple paths to avoid local minima</p>
<hr />
<h3 id="q8-whats-the-computational-cost-of-greedy-decoding">Q8: What's the computational cost of greedy decoding?<a class="headerlink" href="#q8-whats-the-computational-cost-of-greedy-decoding" title="Permanent link">&para;</a></h3>
<p><strong>Answer:</strong> Very efficient:
- <strong>Per step:</strong> O(V) to find argmax over vocabulary
- <strong>Total:</strong> O(T × V) for T tokens
- <strong>Memory:</strong> O(1) for decoding state
- <strong>Fastest</strong> decoding strategy, no beam/sample storage overhead</p>
<hr />
<h3 id="q9-when-would-you-prefer-greedy-over-beam-search">Q9: When would you prefer greedy over beam search?<a class="headerlink" href="#q9-when-would-you-prefer-greedy-over-beam-search" title="Permanent link">&para;</a></h3>
<p><strong>Answer:</strong>
- <strong>Latency-critical applications</strong> (greedy is much faster)
- <strong>Deterministic outputs required</strong> (reproducibility)
- <strong>Single clear answer</strong> (factual Q&amp;A, simple math)
- <strong>Resource-constrained environments</strong> (minimal memory)</p>
<p>Beam search is overkill when diversity isn't needed and the model is confident.</p>
<hr />
<h3 id="q10-how-does-greedy-decoding-interact-with-temperature">Q10: How does greedy decoding interact with temperature?<a class="headerlink" href="#q10-how-does-greedy-decoding-interact-with-temperature" title="Permanent link">&para;</a></h3>
<p><strong>Answer:</strong> Greedy decoding <strong>ignores temperature</strong> because it always picks argmax. Temperature only affects sampling-based methods. You can think of greedy as temperature → 0 (infinitely peaked distribution where highest probability → 1.0, others → 0).</p>
<hr />
<h2 id="8-comparison-with-other-methods">8. Comparison with Other Methods<a class="headerlink" href="#8-comparison-with-other-methods" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Greedy</th>
<th>Beam Search</th>
<th>Sampling</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Speed</strong></td>
<td>Fastest</td>
<td>Slow (K× cost)</td>
<td>Fast</td>
</tr>
<tr>
<td><strong>Diversity</strong></td>
<td>None</td>
<td>Low</td>
<td>High</td>
</tr>
<tr>
<td><strong>Determinism</strong></td>
<td>Yes</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td><strong>Repetition</strong></td>
<td>High risk</td>
<td>Medium risk</td>
<td>Low risk</td>
</tr>
<tr>
<td><strong>Quality</strong></td>
<td>Variable</td>
<td>Higher</td>
<td>Variable</td>
</tr>
<tr>
<td><strong>Memory</strong></td>
<td>Minimal</td>
<td>O(K × T)</td>
<td>Minimal</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="9-code-example">9. Code Example<a class="headerlink" href="#9-code-example" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="k">def</span> <span class="nf">greedy_decode</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">input_ids</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simple greedy decoding implementation.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: Language model with forward() method</span>
<span class="sd">        input_ids: Starting token IDs (tensor)</span>
<span class="sd">        max_length: Maximum sequence length</span>

<span class="sd">    Returns:</span>
<span class="sd">        Generated token IDs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">generated</span> <span class="o">=</span> <span class="n">input_ids</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_length</span><span class="p">):</span>
        <span class="c1"># Get logits for next token</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">generated</span><span class="p">)</span>
            <span class="n">logits</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">logits</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># Last token logits</span>

        <span class="c1"># Greedy selection</span>
        <span class="n">next_token</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Append to sequence</span>
        <span class="n">generated</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">generated</span><span class="p">,</span> <span class="n">next_token</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Check for EOS</span>
        <span class="k">if</span> <span class="n">next_token</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">eos_token_id</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">generated</span>

<span class="c1"># Usage</span>
<span class="c1"># output = greedy_decode(model, prompt_tokens, max_length=100)</span>
</code></pre></div>
<hr />
<h2 id="10-key-takeaways-for-interviews">10. Key Takeaways for Interviews<a class="headerlink" href="#10-key-takeaways-for-interviews" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Definition:</strong> Always picks the highest probability token at each step</li>
<li><strong>Pros:</strong> Fast, deterministic, simple, reproducible</li>
<li><strong>Cons:</strong> No diversity, repetitive, locally optimal only</li>
<li><strong>Main problem:</strong> Repetition loops and generic outputs</li>
<li><strong>Best for:</strong> Deterministic tasks, debugging, factual Q&amp;A</li>
<li><strong>Worst for:</strong> Creative writing, conversations, long-form generation</li>
<li><strong>Complexity:</strong> O(T × V) time, O(1) space for decoding</li>
</ol>
<hr />
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://arxiv.org/abs/1904.09751">The Curious Case of Neural Text Degeneration</a> - Discusses repetition issues</li>
<li><a href="https://huggingface.co/docs/transformers/generation_strategies">Hugging Face: Generation Strategies</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.top", "search.highlight", "search.share", "content.code.copy", "mathjax"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>